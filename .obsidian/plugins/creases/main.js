/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var xs=Object.create;var K=Object.defineProperty,Ts=Object.defineProperties,As=Object.getOwnPropertyDescriptor,Ss=Object.getOwnPropertyDescriptors,Os=Object.getOwnPropertyNames,$e=Object.getOwnPropertySymbols,Ps=Object.getPrototypeOf,Xe=Object.prototype.hasOwnProperty,Fs=Object.prototype.propertyIsEnumerable;var Ye=(e,r,t)=>r in e?K(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,le=(e,r)=>{for(var t in r||(r={}))Xe.call(r,t)&&Ye(e,t,r[t]);if($e)for(var t of $e(r))Fs.call(r,t)&&Ye(e,t,r[t]);return e},ue=(e,r)=>Ts(e,Ss(r)),Ze=e=>K(e,"__esModule",{value:!0});var s=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Es=(e,r)=>{Ze(e);for(var t in r)K(e,t,{get:r[t],enumerable:!0})},Ms=(e,r,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Os(r))!Xe.call(e,n)&&n!=="default"&&K(e,n,{get:()=>r[n],enumerable:!(t=As(r,n))||t.enumerable});return e},P=e=>Ms(Ze(K(e!=null?xs(Ps(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var h=(e,r,t)=>new Promise((n,i)=>{var a=c=>{try{l(t.next(c))}catch(u){i(u)}},o=c=>{try{l(t.throw(c))}catch(u){i(u)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,o);l((t=t.apply(e,r)).next())});var be=s((cg,Je)=>{function Ls(e,r){for(var t=-1,n=r.length,i=e.length;++t<n;)e[i+t]=r[t];return e}Je.exports=Ls});var we=s((pg,Qe)=>{var Is=typeof global=="object"&&global&&global.Object===Object&&global;Qe.exports=Is});var q=s((dg,er)=>{var Ds=we(),ks=typeof self=="object"&&self&&self.Object===Object&&self,Rs=Ds||ks||Function("return this")();er.exports=Rs});var E=s((fg,rr)=>{var Ns=q(),Bs=Ns.Symbol;rr.exports=Bs});var ar=s((hg,ir)=>{var tr=E(),nr=Object.prototype,Gs=nr.hasOwnProperty,Hs=nr.toString,U=tr?tr.toStringTag:void 0;function js(e){var r=Gs.call(e,U),t=e[U];try{e[U]=void 0;var n=!0}catch(a){}var i=Hs.call(e);return n&&(r?e[U]=t:delete e[U]),i}ir.exports=js});var or=s((gg,sr)=>{var Vs=Object.prototype,Ks=Vs.toString;function Us(e){return Ks.call(e)}sr.exports=Us});var M=s((vg,cr)=>{var lr=E(),zs=ar(),Ws=or(),$s="[object Null]",Xs="[object Undefined]",ur=lr?lr.toStringTag:void 0;function Ys(e){return e==null?e===void 0?Xs:$s:ur&&ur in Object(e)?zs(e):Ws(e)}cr.exports=Ys});var L=s((yg,pr)=>{function Zs(e){return e!=null&&typeof e=="object"}pr.exports=Zs});var fr=s((_g,dr)=>{var Js=M(),Qs=L(),eo="[object Arguments]";function ro(e){return Qs(e)&&Js(e)==eo}dr.exports=ro});var ce=s((mg,vr)=>{var hr=fr(),to=L(),gr=Object.prototype,no=gr.hasOwnProperty,io=gr.propertyIsEnumerable,ao=hr(function(){return arguments}())?hr:function(e){return to(e)&&no.call(e,"callee")&&!io.call(e,"callee")};vr.exports=ao});var w=s((bg,yr)=>{var so=Array.isArray;yr.exports=so});var wr=s((wg,br)=>{var _r=E(),oo=ce(),lo=w(),mr=_r?_r.isConcatSpreadable:void 0;function uo(e){return lo(e)||oo(e)||!!(mr&&e&&e[mr])}br.exports=uo});var xr=s((qg,Cr)=>{var co=be(),po=wr();function qr(e,r,t,n,i){var a=-1,o=e.length;for(t||(t=po),i||(i=[]);++a<o;){var l=e[a];r>0&&t(l)?r>1?qr(l,r-1,t,n,i):co(i,l):n||(i[i.length]=l)}return i}Cr.exports=qr});var qe=s((Cg,Tr)=>{function fo(e,r){for(var t=-1,n=e==null?0:e.length,i=Array(n);++t<n;)i[t]=r(e[t],t,e);return i}Tr.exports=fo});var z=s((xg,Ar)=>{var ho=M(),go=L(),vo="[object Symbol]";function yo(e){return typeof e=="symbol"||go(e)&&ho(e)==vo}Ar.exports=yo});var pe=s((Tg,Sr)=>{var _o=w(),mo=z(),bo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,wo=/^\w*$/;function qo(e,r){if(_o(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||mo(e)?!0:wo.test(e)||!bo.test(e)||r!=null&&e in Object(r)}Sr.exports=qo});var W=s((Ag,Or)=>{function Co(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}Or.exports=Co});var Ce=s((Sg,Pr)=>{var xo=M(),To=W(),Ao="[object AsyncFunction]",So="[object Function]",Oo="[object GeneratorFunction]",Po="[object Proxy]";function Fo(e){if(!To(e))return!1;var r=xo(e);return r==So||r==Oo||r==Ao||r==Po}Pr.exports=Fo});var Er=s((Og,Fr)=>{var Eo=q(),Mo=Eo["__core-js_shared__"];Fr.exports=Mo});var Ir=s((Pg,Lr)=>{var xe=Er(),Mr=function(){var e=/[^.]+$/.exec(xe&&xe.keys&&xe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Lo(e){return!!Mr&&Mr in e}Lr.exports=Lo});var Te=s((Fg,Dr)=>{var Io=Function.prototype,Do=Io.toString;function ko(e){if(e!=null){try{return Do.call(e)}catch(r){}try{return e+""}catch(r){}}return""}Dr.exports=ko});var Rr=s((Eg,kr)=>{var Ro=Ce(),No=Ir(),Bo=W(),Go=Te(),Ho=/[\\^$.*+?()[\]{}|]/g,jo=/^\[object .+?Constructor\]$/,Vo=Function.prototype,Ko=Object.prototype,Uo=Vo.toString,zo=Ko.hasOwnProperty,Wo=RegExp("^"+Uo.call(zo).replace(Ho,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $o(e){if(!Bo(e)||No(e))return!1;var r=Ro(e)?Wo:jo;return r.test(Go(e))}kr.exports=$o});var Br=s((Mg,Nr)=>{function Xo(e,r){return e==null?void 0:e[r]}Nr.exports=Xo});var A=s((Lg,Gr)=>{var Yo=Rr(),Zo=Br();function Jo(e,r){var t=Zo(e,r);return Yo(t)?t:void 0}Gr.exports=Jo});var $=s((Ig,Hr)=>{var Qo=A(),el=Qo(Object,"create");Hr.exports=el});var Kr=s((Dg,Vr)=>{var jr=$();function rl(){this.__data__=jr?jr(null):{},this.size=0}Vr.exports=rl});var zr=s((kg,Ur)=>{function tl(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}Ur.exports=tl});var $r=s((Rg,Wr)=>{var nl=$(),il="__lodash_hash_undefined__",al=Object.prototype,sl=al.hasOwnProperty;function ol(e){var r=this.__data__;if(nl){var t=r[e];return t===il?void 0:t}return sl.call(r,e)?r[e]:void 0}Wr.exports=ol});var Yr=s((Ng,Xr)=>{var ll=$(),ul=Object.prototype,cl=ul.hasOwnProperty;function pl(e){var r=this.__data__;return ll?r[e]!==void 0:cl.call(r,e)}Xr.exports=pl});var Jr=s((Bg,Zr)=>{var dl=$(),fl="__lodash_hash_undefined__";function hl(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=dl&&r===void 0?fl:r,this}Zr.exports=hl});var et=s((Gg,Qr)=>{var gl=Kr(),vl=zr(),yl=$r(),_l=Yr(),ml=Jr();function I(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}I.prototype.clear=gl;I.prototype.delete=vl;I.prototype.get=yl;I.prototype.has=_l;I.prototype.set=ml;Qr.exports=I});var tt=s((Hg,rt)=>{function bl(){this.__data__=[],this.size=0}rt.exports=bl});var de=s((jg,nt)=>{function wl(e,r){return e===r||e!==e&&r!==r}nt.exports=wl});var X=s((Vg,it)=>{var ql=de();function Cl(e,r){for(var t=e.length;t--;)if(ql(e[t][0],r))return t;return-1}it.exports=Cl});var st=s((Kg,at)=>{var xl=X(),Tl=Array.prototype,Al=Tl.splice;function Sl(e){var r=this.__data__,t=xl(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():Al.call(r,t,1),--this.size,!0}at.exports=Sl});var lt=s((Ug,ot)=>{var Ol=X();function Pl(e){var r=this.__data__,t=Ol(r,e);return t<0?void 0:r[t][1]}ot.exports=Pl});var ct=s((zg,ut)=>{var Fl=X();function El(e){return Fl(this.__data__,e)>-1}ut.exports=El});var dt=s((Wg,pt)=>{var Ml=X();function Ll(e,r){var t=this.__data__,n=Ml(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}pt.exports=Ll});var Y=s(($g,ft)=>{var Il=tt(),Dl=st(),kl=lt(),Rl=ct(),Nl=dt();function D(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}D.prototype.clear=Il;D.prototype.delete=Dl;D.prototype.get=kl;D.prototype.has=Rl;D.prototype.set=Nl;ft.exports=D});var fe=s((Xg,ht)=>{var Bl=A(),Gl=q(),Hl=Bl(Gl,"Map");ht.exports=Hl});var yt=s((Yg,vt)=>{var gt=et(),jl=Y(),Vl=fe();function Kl(){this.size=0,this.__data__={hash:new gt,map:new(Vl||jl),string:new gt}}vt.exports=Kl});var mt=s((Zg,_t)=>{function Ul(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}_t.exports=Ul});var Z=s((Jg,bt)=>{var zl=mt();function Wl(e,r){var t=e.__data__;return zl(r)?t[typeof r=="string"?"string":"hash"]:t.map}bt.exports=Wl});var qt=s((Qg,wt)=>{var $l=Z();function Xl(e){var r=$l(this,e).delete(e);return this.size-=r?1:0,r}wt.exports=Xl});var xt=s((ev,Ct)=>{var Yl=Z();function Zl(e){return Yl(this,e).get(e)}Ct.exports=Zl});var At=s((rv,Tt)=>{var Jl=Z();function Ql(e){return Jl(this,e).has(e)}Tt.exports=Ql});var Ot=s((tv,St)=>{var eu=Z();function ru(e,r){var t=eu(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}St.exports=ru});var he=s((nv,Pt)=>{var tu=yt(),nu=qt(),iu=xt(),au=At(),su=Ot();function k(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}k.prototype.clear=tu;k.prototype.delete=nu;k.prototype.get=iu;k.prototype.has=au;k.prototype.set=su;Pt.exports=k});var Mt=s((iv,Et)=>{var Ft=he(),ou="Expected a function";function Ae(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(ou);var t=function(){var n=arguments,i=r?r.apply(this,n):n[0],a=t.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return t.cache=a.set(i,o)||a,o};return t.cache=new(Ae.Cache||Ft),t}Ae.Cache=Ft;Et.exports=Ae});var It=s((av,Lt)=>{var lu=Mt(),uu=500;function cu(e){var r=lu(e,function(n){return t.size===uu&&t.clear(),n}),t=r.cache;return r}Lt.exports=cu});var kt=s((sv,Dt)=>{var pu=It(),du=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fu=/\\(\\)?/g,hu=pu(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(du,function(t,n,i,a){r.push(i?a.replace(fu,"$1"):n||t)}),r});Dt.exports=hu});var jt=s((ov,Ht)=>{var Rt=E(),gu=qe(),vu=w(),yu=z(),_u=1/0,Nt=Rt?Rt.prototype:void 0,Bt=Nt?Nt.toString:void 0;function Gt(e){if(typeof e=="string")return e;if(vu(e))return gu(e,Gt)+"";if(yu(e))return Bt?Bt.call(e):"";var r=e+"";return r=="0"&&1/e==-_u?"-0":r}Ht.exports=Gt});var Kt=s((lv,Vt)=>{var mu=jt();function bu(e){return e==null?"":mu(e)}Vt.exports=bu});var ge=s((uv,Ut)=>{var wu=w(),qu=pe(),Cu=kt(),xu=Kt();function Tu(e,r){return wu(e)?e:qu(e,r)?[e]:Cu(xu(e))}Ut.exports=Tu});var R=s((cv,zt)=>{var Au=z(),Su=1/0;function Ou(e){if(typeof e=="string"||Au(e))return e;var r=e+"";return r=="0"&&1/e==-Su?"-0":r}zt.exports=Ou});var J=s((pv,Wt)=>{var Pu=ge(),Fu=R();function Eu(e,r){r=Pu(r,e);for(var t=0,n=r.length;e!=null&&t<n;)e=e[Fu(r[t++])];return t&&t==n?e:void 0}Wt.exports=Eu});var Xt=s((dv,$t)=>{var Mu=Y();function Lu(){this.__data__=new Mu,this.size=0}$t.exports=Lu});var Zt=s((fv,Yt)=>{function Iu(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}Yt.exports=Iu});var Qt=s((hv,Jt)=>{function Du(e){return this.__data__.get(e)}Jt.exports=Du});var rn=s((gv,en)=>{function ku(e){return this.__data__.has(e)}en.exports=ku});var nn=s((vv,tn)=>{var Ru=Y(),Nu=fe(),Bu=he(),Gu=200;function Hu(e,r){var t=this.__data__;if(t instanceof Ru){var n=t.__data__;if(!Nu||n.length<Gu-1)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new Bu(n)}return t.set(e,r),this.size=t.size,this}tn.exports=Hu});var Se=s((yv,an)=>{var ju=Y(),Vu=Xt(),Ku=Zt(),Uu=Qt(),zu=rn(),Wu=nn();function N(e){var r=this.__data__=new ju(e);this.size=r.size}N.prototype.clear=Vu;N.prototype.delete=Ku;N.prototype.get=Uu;N.prototype.has=zu;N.prototype.set=Wu;an.exports=N});var on=s((_v,sn)=>{var $u="__lodash_hash_undefined__";function Xu(e){return this.__data__.set(e,$u),this}sn.exports=Xu});var un=s((mv,ln)=>{function Yu(e){return this.__data__.has(e)}ln.exports=Yu});var pn=s((bv,cn)=>{var Zu=he(),Ju=on(),Qu=un();function ve(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new Zu;++r<t;)this.add(e[r])}ve.prototype.add=ve.prototype.push=Ju;ve.prototype.has=Qu;cn.exports=ve});var fn=s((wv,dn)=>{function ec(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}dn.exports=ec});var gn=s((qv,hn)=>{function rc(e,r){return e.has(r)}hn.exports=rc});var Oe=s((Cv,vn)=>{var tc=pn(),nc=fn(),ic=gn(),ac=1,sc=2;function oc(e,r,t,n,i,a){var o=t&ac,l=e.length,c=r.length;if(l!=c&&!(o&&c>l))return!1;var u=a.get(e),p=a.get(r);if(u&&p)return u==r&&p==e;var f=-1,d=!0,v=t&sc?new tc:void 0;for(a.set(e,r),a.set(r,e);++f<l;){var m=e[f],b=r[f];if(n)var T=o?n(b,m,f,r,e,a):n(m,b,f,e,r,a);if(T!==void 0){if(T)continue;d=!1;break}if(v){if(!nc(r,function(S,O){if(!ic(v,O)&&(m===S||i(m,S,t,n,a)))return v.push(O)})){d=!1;break}}else if(!(m===b||i(m,b,t,n,a))){d=!1;break}}return a.delete(e),a.delete(r),d}vn.exports=oc});var _n=s((xv,yn)=>{var lc=q(),uc=lc.Uint8Array;yn.exports=uc});var bn=s((Tv,mn)=>{function cc(e){var r=-1,t=Array(e.size);return e.forEach(function(n,i){t[++r]=[i,n]}),t}mn.exports=cc});var qn=s((Av,wn)=>{function pc(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}wn.exports=pc});var Sn=s((Sv,An)=>{var Cn=E(),xn=_n(),dc=de(),fc=Oe(),hc=bn(),gc=qn(),vc=1,yc=2,_c="[object Boolean]",mc="[object Date]",bc="[object Error]",wc="[object Map]",qc="[object Number]",Cc="[object RegExp]",xc="[object Set]",Tc="[object String]",Ac="[object Symbol]",Sc="[object ArrayBuffer]",Oc="[object DataView]",Tn=Cn?Cn.prototype:void 0,Pe=Tn?Tn.valueOf:void 0;function Pc(e,r,t,n,i,a,o){switch(t){case Oc:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case Sc:return!(e.byteLength!=r.byteLength||!a(new xn(e),new xn(r)));case _c:case mc:case qc:return dc(+e,+r);case bc:return e.name==r.name&&e.message==r.message;case Cc:case Tc:return e==r+"";case wc:var l=hc;case xc:var c=n&vc;if(l||(l=gc),e.size!=r.size&&!c)return!1;var u=o.get(e);if(u)return u==r;n|=yc,o.set(e,r);var p=fc(l(e),l(r),n,i,a,o);return o.delete(e),p;case Ac:if(Pe)return Pe.call(e)==Pe.call(r)}return!1}An.exports=Pc});var Pn=s((Ov,On)=>{var Fc=be(),Ec=w();function Mc(e,r,t){var n=r(e);return Ec(e)?n:Fc(n,t(e))}On.exports=Mc});var En=s((Pv,Fn)=>{function Lc(e,r){for(var t=-1,n=e==null?0:e.length,i=0,a=[];++t<n;){var o=e[t];r(o,t,e)&&(a[i++]=o)}return a}Fn.exports=Lc});var Ln=s((Fv,Mn)=>{function Ic(){return[]}Mn.exports=Ic});var kn=s((Ev,Dn)=>{var Dc=En(),kc=Ln(),Rc=Object.prototype,Nc=Rc.propertyIsEnumerable,In=Object.getOwnPropertySymbols,Bc=In?function(e){return e==null?[]:(e=Object(e),Dc(In(e),function(r){return Nc.call(e,r)}))}:kc;Dn.exports=Bc});var Nn=s((Mv,Rn)=>{function Gc(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}Rn.exports=Gc});var Gn=s((Lv,Bn)=>{function Hc(){return!1}Bn.exports=Hc});var Fe=s((Q,B)=>{var jc=q(),Vc=Gn(),Hn=typeof Q=="object"&&Q&&!Q.nodeType&&Q,jn=Hn&&typeof B=="object"&&B&&!B.nodeType&&B,Kc=jn&&jn.exports===Hn,Vn=Kc?jc.Buffer:void 0,Uc=Vn?Vn.isBuffer:void 0,zc=Uc||Vc;B.exports=zc});var ee=s((Iv,Kn)=>{var Wc=9007199254740991,$c=/^(?:0|[1-9]\d*)$/;function Xc(e,r){var t=typeof e;return r=r==null?Wc:r,!!r&&(t=="number"||t!="symbol"&&$c.test(e))&&e>-1&&e%1==0&&e<r}Kn.exports=Xc});var ye=s((Dv,Un)=>{var Yc=9007199254740991;function Zc(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Yc}Un.exports=Zc});var Wn=s((kv,zn)=>{var Jc=M(),Qc=ye(),ep=L(),rp="[object Arguments]",tp="[object Array]",np="[object Boolean]",ip="[object Date]",ap="[object Error]",sp="[object Function]",op="[object Map]",lp="[object Number]",up="[object Object]",cp="[object RegExp]",pp="[object Set]",dp="[object String]",fp="[object WeakMap]",hp="[object ArrayBuffer]",gp="[object DataView]",vp="[object Float32Array]",yp="[object Float64Array]",_p="[object Int8Array]",mp="[object Int16Array]",bp="[object Int32Array]",wp="[object Uint8Array]",qp="[object Uint8ClampedArray]",Cp="[object Uint16Array]",xp="[object Uint32Array]",g={};g[vp]=g[yp]=g[_p]=g[mp]=g[bp]=g[wp]=g[qp]=g[Cp]=g[xp]=!0;g[rp]=g[tp]=g[hp]=g[np]=g[gp]=g[ip]=g[ap]=g[sp]=g[op]=g[lp]=g[up]=g[cp]=g[pp]=g[dp]=g[fp]=!1;function Tp(e){return ep(e)&&Qc(e.length)&&!!g[Jc(e)]}zn.exports=Tp});var Ee=s((Rv,$n)=>{function Ap(e){return function(r){return e(r)}}$n.exports=Ap});var Yn=s((te,G)=>{var Sp=we(),Xn=typeof te=="object"&&te&&!te.nodeType&&te,re=Xn&&typeof G=="object"&&G&&!G.nodeType&&G,Op=re&&re.exports===Xn,Me=Op&&Sp.process,Pp=function(){try{var e=re&&re.require&&re.require("util").types;return e||Me&&Me.binding&&Me.binding("util")}catch(r){}}();G.exports=Pp});var Le=s((Nv,Qn)=>{var Fp=Wn(),Ep=Ee(),Zn=Yn(),Jn=Zn&&Zn.isTypedArray,Mp=Jn?Ep(Jn):Fp;Qn.exports=Mp});var ri=s((Bv,ei)=>{var Lp=Nn(),Ip=ce(),Dp=w(),kp=Fe(),Rp=ee(),Np=Le(),Bp=Object.prototype,Gp=Bp.hasOwnProperty;function Hp(e,r){var t=Dp(e),n=!t&&Ip(e),i=!t&&!n&&kp(e),a=!t&&!n&&!i&&Np(e),o=t||n||i||a,l=o?Lp(e.length,String):[],c=l.length;for(var u in e)(r||Gp.call(e,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Rp(u,c)))&&l.push(u);return l}ei.exports=Hp});var ni=s((Gv,ti)=>{var jp=Object.prototype;function Vp(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||jp;return e===t}ti.exports=Vp});var ai=s((Hv,ii)=>{function Kp(e,r){return function(t){return e(r(t))}}ii.exports=Kp});var oi=s((jv,si)=>{var Up=ai(),zp=Up(Object.keys,Object);si.exports=zp});var ui=s((Vv,li)=>{var Wp=ni(),$p=oi(),Xp=Object.prototype,Yp=Xp.hasOwnProperty;function Zp(e){if(!Wp(e))return $p(e);var r=[];for(var t in Object(e))Yp.call(e,t)&&t!="constructor"&&r.push(t);return r}li.exports=Zp});var ne=s((Kv,ci)=>{var Jp=Ce(),Qp=ye();function ed(e){return e!=null&&Qp(e.length)&&!Jp(e)}ci.exports=ed});var _e=s((Uv,pi)=>{var rd=ri(),td=ui(),nd=ne();function id(e){return nd(e)?rd(e):td(e)}pi.exports=id});var fi=s((zv,di)=>{var ad=Pn(),sd=kn(),od=_e();function ld(e){return ad(e,od,sd)}di.exports=ld});var vi=s((Wv,gi)=>{var hi=fi(),ud=1,cd=Object.prototype,pd=cd.hasOwnProperty;function dd(e,r,t,n,i,a){var o=t&ud,l=hi(e),c=l.length,u=hi(r),p=u.length;if(c!=p&&!o)return!1;for(var f=c;f--;){var d=l[f];if(!(o?d in r:pd.call(r,d)))return!1}var v=a.get(e),m=a.get(r);if(v&&m)return v==r&&m==e;var b=!0;a.set(e,r),a.set(r,e);for(var T=o;++f<c;){d=l[f];var S=e[d],O=r[d];if(n)var We=o?n(O,S,d,r,e,a):n(S,O,d,e,r,a);if(!(We===void 0?S===O||i(S,O,t,n,a):We)){b=!1;break}T||(T=d=="constructor")}if(b&&!T){var se=e.constructor,oe=r.constructor;se!=oe&&"constructor"in e&&"constructor"in r&&!(typeof se=="function"&&se instanceof se&&typeof oe=="function"&&oe instanceof oe)&&(b=!1)}return a.delete(e),a.delete(r),b}gi.exports=dd});var _i=s(($v,yi)=>{var fd=A(),hd=q(),gd=fd(hd,"DataView");yi.exports=gd});var bi=s((Xv,mi)=>{var vd=A(),yd=q(),_d=vd(yd,"Promise");mi.exports=_d});var qi=s((Yv,wi)=>{var md=A(),bd=q(),wd=md(bd,"Set");wi.exports=wd});var xi=s((Zv,Ci)=>{var qd=A(),Cd=q(),xd=qd(Cd,"WeakMap");Ci.exports=xd});var Mi=s((Jv,Ei)=>{var Ie=_i(),De=fe(),ke=bi(),Re=qi(),Ne=xi(),Ti=M(),H=Te(),Ai="[object Map]",Td="[object Object]",Si="[object Promise]",Oi="[object Set]",Pi="[object WeakMap]",Fi="[object DataView]",Ad=H(Ie),Sd=H(De),Od=H(ke),Pd=H(Re),Fd=H(Ne),F=Ti;(Ie&&F(new Ie(new ArrayBuffer(1)))!=Fi||De&&F(new De)!=Ai||ke&&F(ke.resolve())!=Si||Re&&F(new Re)!=Oi||Ne&&F(new Ne)!=Pi)&&(F=function(e){var r=Ti(e),t=r==Td?e.constructor:void 0,n=t?H(t):"";if(n)switch(n){case Ad:return Fi;case Sd:return Ai;case Od:return Si;case Pd:return Oi;case Fd:return Pi}return r});Ei.exports=F});var Gi=s((Qv,Bi)=>{var Be=Se(),Ed=Oe(),Md=Sn(),Ld=vi(),Li=Mi(),Ii=w(),Di=Fe(),Id=Le(),Dd=1,ki="[object Arguments]",Ri="[object Array]",me="[object Object]",kd=Object.prototype,Ni=kd.hasOwnProperty;function Rd(e,r,t,n,i,a){var o=Ii(e),l=Ii(r),c=o?Ri:Li(e),u=l?Ri:Li(r);c=c==ki?me:c,u=u==ki?me:u;var p=c==me,f=u==me,d=c==u;if(d&&Di(e)){if(!Di(r))return!1;o=!0,p=!1}if(d&&!p)return a||(a=new Be),o||Id(e)?Ed(e,r,t,n,i,a):Md(e,r,c,t,n,i,a);if(!(t&Dd)){var v=p&&Ni.call(e,"__wrapped__"),m=f&&Ni.call(r,"__wrapped__");if(v||m){var b=v?e.value():e,T=m?r.value():r;return a||(a=new Be),i(b,T,t,n,a)}}return d?(a||(a=new Be),Ld(e,r,t,n,i,a)):!1}Bi.exports=Rd});var Ge=s((ey,Vi)=>{var Nd=Gi(),Hi=L();function ji(e,r,t,n,i){return e===r?!0:e==null||r==null||!Hi(e)&&!Hi(r)?e!==e&&r!==r:Nd(e,r,t,n,ji,i)}Vi.exports=ji});var Ui=s((ry,Ki)=>{var Bd=Se(),Gd=Ge(),Hd=1,jd=2;function Vd(e,r,t,n){var i=t.length,a=i,o=!n;if(e==null)return!a;for(e=Object(e);i--;){var l=t[i];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<a;){l=t[i];var c=l[0],u=e[c],p=l[1];if(o&&l[2]){if(u===void 0&&!(c in e))return!1}else{var f=new Bd;if(n)var d=n(u,p,c,e,r,f);if(!(d===void 0?Gd(p,u,Hd|jd,n,f):d))return!1}}return!0}Ki.exports=Vd});var He=s((ty,zi)=>{var Kd=W();function Ud(e){return e===e&&!Kd(e)}zi.exports=Ud});var $i=s((ny,Wi)=>{var zd=He(),Wd=_e();function $d(e){for(var r=Wd(e),t=r.length;t--;){var n=r[t],i=e[n];r[t]=[n,i,zd(i)]}return r}Wi.exports=$d});var je=s((iy,Xi)=>{function Xd(e,r){return function(t){return t==null?!1:t[e]===r&&(r!==void 0||e in Object(t))}}Xi.exports=Xd});var Zi=s((ay,Yi)=>{var Yd=Ui(),Zd=$i(),Jd=je();function Qd(e){var r=Zd(e);return r.length==1&&r[0][2]?Jd(r[0][0],r[0][1]):function(t){return t===e||Yd(t,e,r)}}Yi.exports=Qd});var Qi=s((sy,Ji)=>{var ef=J();function rf(e,r,t){var n=e==null?void 0:ef(e,r);return n===void 0?t:n}Ji.exports=rf});var ra=s((oy,ea)=>{function tf(e,r){return e!=null&&r in Object(e)}ea.exports=tf});var na=s((ly,ta)=>{var nf=ge(),af=ce(),sf=w(),of=ee(),lf=ye(),uf=R();function cf(e,r,t){r=nf(r,e);for(var n=-1,i=r.length,a=!1;++n<i;){var o=uf(r[n]);if(!(a=e!=null&&t(e,o)))break;e=e[o]}return a||++n!=i?a:(i=e==null?0:e.length,!!i&&lf(i)&&of(o,i)&&(sf(e)||af(e)))}ta.exports=cf});var aa=s((uy,ia)=>{var pf=ra(),df=na();function ff(e,r){return e!=null&&df(e,r,pf)}ia.exports=ff});var oa=s((cy,sa)=>{var hf=Ge(),gf=Qi(),vf=aa(),yf=pe(),_f=He(),mf=je(),bf=R(),wf=1,qf=2;function Cf(e,r){return yf(e)&&_f(r)?mf(bf(e),r):function(t){var n=gf(t,e);return n===void 0&&n===r?vf(t,e):hf(r,n,wf|qf)}}sa.exports=Cf});var ie=s((py,la)=>{function xf(e){return e}la.exports=xf});var ca=s((dy,ua)=>{function Tf(e){return function(r){return r==null?void 0:r[e]}}ua.exports=Tf});var da=s((fy,pa)=>{var Af=J();function Sf(e){return function(r){return Af(r,e)}}pa.exports=Sf});var ha=s((hy,fa)=>{var Of=ca(),Pf=da(),Ff=pe(),Ef=R();function Mf(e){return Ff(e)?Of(Ef(e)):Pf(e)}fa.exports=Mf});var Ve=s((gy,ga)=>{var Lf=Zi(),If=oa(),Df=ie(),kf=w(),Rf=ha();function Nf(e){return typeof e=="function"?e:e==null?Df:typeof e=="object"?kf(e)?If(e[0],e[1]):Lf(e):Rf(e)}ga.exports=Nf});var ya=s((vy,va)=>{function Bf(e){return function(r,t,n){for(var i=-1,a=Object(r),o=n(r),l=o.length;l--;){var c=o[e?l:++i];if(t(a[c],c,a)===!1)break}return r}}va.exports=Bf});var ma=s((yy,_a)=>{var Gf=ya(),Hf=Gf();_a.exports=Hf});var wa=s((_y,ba)=>{var jf=ma(),Vf=_e();function Kf(e,r){return e&&jf(e,r,Vf)}ba.exports=Kf});var Ca=s((my,qa)=>{var Uf=ne();function zf(e,r){return function(t,n){if(t==null)return t;if(!Uf(t))return e(t,n);for(var i=t.length,a=r?i:-1,o=Object(t);(r?a--:++a<i)&&n(o[a],a,o)!==!1;);return t}}qa.exports=zf});var Ta=s((by,xa)=>{var Wf=wa(),$f=Ca(),Xf=$f(Wf);xa.exports=Xf});var Sa=s((wy,Aa)=>{var Yf=Ta(),Zf=ne();function Jf(e,r){var t=-1,n=Zf(e)?Array(e.length):[];return Yf(e,function(i,a,o){n[++t]=r(i,a,o)}),n}Aa.exports=Jf});var Pa=s((qy,Oa)=>{function Qf(e,r){var t=e.length;for(e.sort(r);t--;)e[t]=e[t].value;return e}Oa.exports=Qf});var Ma=s((Cy,Ea)=>{var Fa=z();function eh(e,r){if(e!==r){var t=e!==void 0,n=e===null,i=e===e,a=Fa(e),o=r!==void 0,l=r===null,c=r===r,u=Fa(r);if(!l&&!u&&!a&&e>r||a&&o&&c&&!l&&!u||n&&o&&c||!t&&c||!i)return 1;if(!n&&!a&&!u&&e<r||u&&t&&i&&!n&&!a||l&&t&&i||!o&&i||!c)return-1}return 0}Ea.exports=eh});var Ia=s((xy,La)=>{var rh=Ma();function th(e,r,t){for(var n=-1,i=e.criteria,a=r.criteria,o=i.length,l=t.length;++n<o;){var c=rh(i[n],a[n]);if(c){if(n>=l)return c;var u=t[n];return c*(u=="desc"?-1:1)}}return e.index-r.index}La.exports=th});var ka=s((Ty,Da)=>{var Ke=qe(),nh=J(),ih=Ve(),ah=Sa(),sh=Pa(),oh=Ee(),lh=Ia(),uh=ie(),ch=w();function ph(e,r,t){r.length?r=Ke(r,function(a){return ch(a)?function(o){return nh(o,a.length===1?a[0]:a)}:a}):r=[uh];var n=-1;r=Ke(r,oh(ih));var i=ah(e,function(a,o,l){var c=Ke(r,function(u){return u(a)});return{criteria:c,index:++n,value:a}});return sh(i,function(a,o){return lh(a,o,t)})}Da.exports=ph});var Na=s((Ay,Ra)=>{function dh(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}Ra.exports=dh});var Ha=s((Sy,Ga)=>{var fh=Na(),Ba=Math.max;function hh(e,r,t){return r=Ba(r===void 0?e.length-1:r,0),function(){for(var n=arguments,i=-1,a=Ba(n.length-r,0),o=Array(a);++i<a;)o[i]=n[r+i];i=-1;for(var l=Array(r+1);++i<r;)l[i]=n[i];return l[r]=t(o),fh(e,this,l)}}Ga.exports=hh});var Va=s((Oy,ja)=>{function gh(e){return function(){return e}}ja.exports=gh});var Ua=s((Py,Ka)=>{var vh=A(),yh=function(){try{var e=vh(Object,"defineProperty");return e({},"",{}),e}catch(r){}}();Ka.exports=yh});var $a=s((Fy,Wa)=>{var _h=Va(),za=Ua(),mh=ie(),bh=za?function(e,r){return za(e,"toString",{configurable:!0,enumerable:!1,value:_h(r),writable:!0})}:mh;Wa.exports=bh});var Ya=s((Ey,Xa)=>{var wh=800,qh=16,Ch=Date.now;function xh(e){var r=0,t=0;return function(){var n=Ch(),i=qh-(n-t);if(t=n,i>0){if(++r>=wh)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}Xa.exports=xh});var Ja=s((My,Za)=>{var Th=$a(),Ah=Ya(),Sh=Ah(Th);Za.exports=Sh});var es=s((Ly,Qa)=>{var Oh=ie(),Ph=Ha(),Fh=Ja();function Eh(e,r){return Fh(Ph(e,r,Oh),e+"")}Qa.exports=Eh});var ts=s((Iy,rs)=>{var Mh=de(),Lh=ne(),Ih=ee(),Dh=W();function kh(e,r,t){if(!Dh(t))return!1;var n=typeof r;return(n=="number"?Lh(t)&&Ih(r,t.length):n=="string"&&r in t)?Mh(t[r],e):!1}rs.exports=kh});var as=s((Dy,is)=>{var Rh=xr(),Nh=ka(),Bh=es(),ns=ts(),Gh=Bh(function(e,r){if(e==null)return[];var t=r.length;return t>1&&ns(e,r[0],r[1])?r=[]:t>2&&ns(r[0],r[1],r[2])&&(r=[r[0]]),Nh(e,Rh(r,1),[])});is.exports=Gh});var os=s((ky,ss)=>{function Hh(e){var r=e==null?0:e.length;return r?e[r-1]:void 0}ss.exports=Hh});var us=s((Ry,ls)=>{function jh(e,r,t){var n=-1,i=e.length;r<0&&(r=-r>i?0:i+r),t=t>i?i:t,t<0&&(t+=i),i=r>t?0:t-r>>>0,r>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+r];return a}ls.exports=jh});var ps=s((Ny,cs)=>{var Vh=J(),Kh=us();function Uh(e,r){return r.length<2?e:Vh(e,Kh(r,0,-1))}cs.exports=Uh});var fs=s((By,ds)=>{var zh=ge(),Wh=os(),$h=ps(),Xh=R();function Yh(e,r){return r=zh(r,e),e=$h(e,r),e==null||delete e[Xh(Wh(r))]}ds.exports=Yh});var gs=s((Gy,hs)=>{var Zh=fs(),Jh=ee(),Qh=Array.prototype,eg=Qh.splice;function rg(e,r){for(var t=e?r.length:0,n=t-1;t--;){var i=r[t];if(t==n||i!==a){var a=i;Jh(i)?eg.call(e,i,1):Zh(e,i)}}return e}hs.exports=rg});var ys=s((Hy,vs)=>{var tg=Ve(),ng=gs();function ig(e,r){var t=[];if(!(e&&e.length))return t;var n=-1,i=[],a=e.length;for(r=tg(r,3);++n<a;){var o=e[n];r(o,n,e)&&(t.push(o),i.push(n))}return ng(e,i),t}vs.exports=ig});Es(exports,{default:()=>ze});var ws=P(as()),qs=P(ys()),y=P(require("obsidian")),Cs=P(require("@codemirror/language"));function ae(e,r){let t=Object.keys(r).map(n=>ag(e,n,r[n]));return t.length===1?t[0]:function(){t.forEach(n=>n())}}function ag(e,r,t){let n=e[r],i=e.hasOwnProperty(r),a=t(n);return n&&Object.setPrototypeOf(a,n),Object.setPrototypeOf(o,a),e[r]=o,l;function o(...c){return a===n&&e[r]===o&&l(),a.apply(this,c)}function l(){e[r]===o&&(i?e[r]=n:delete e[r]),a!==n&&(a=n,Object.setPrototypeOf(o,n||Function))}}var _=P(require("@codemirror/view")),j=P(require("obsidian")),_s=class extends _.WidgetType{constructor(r,t,n,i){super();this.app=r;this.view=t;this.from=n;this.to=i}eq(r){return r.view===this.view&&r.from===this.from&&r.to===this.to}toDOM(){let r=createSpan("cm-creases-icon");return(0,j.setIcon)(r,"shirt",12),r.addEventListener("click",t=>{new j.Menu(this.app).addItem(i=>i.setTitle("Remove crease").setIcon("x").onClick(()=>{this.view.dispatch({changes:{from:this.from,to:this.to,insert:""}})})).showAtMouseEvent(t)}),r}ignoreEvent(){return!1}};function ms(e){return _.ViewPlugin.fromClass(class{constructor(r){this.view=r;this.decorations=_.Decoration.none;this.allDecos=_.Decoration.none;this.decorator=new _.MatchDecorator({regexp:/\B%%\s+fold\s+%%\B/g,decoration:this.getDeco.bind(this)}),this.decorations=this.decorator.createDeco(r)}getDeco(r,t,n){let i=n,a=n+r[0].length;return _.Decoration.replace({widget:new _s(e,this.view,i,a)})}update(r){if(!r.state.field(j.editorLivePreviewField)){this.decorations=_.Decoration.none;return}this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations,provide:_.PluginField.atomicRanges.from(r=>r.decorations)})}var C=/%% +fold +%%/;function x(e){return C.test(e)}var V=P(require("obsidian")),bs={onOpenCreasesBehavior:"preserve-fold-state",templateCreasesBehavior:"start-folded",syncOutlineView:"from-editor-to-outline"},Ue=class extends V.PluginSettingTab{constructor(r,t){super(r,t);this.plugin=t}display(){let{containerEl:r}=this;r.empty(),r.createEl("h3",{text:"Folding"}),new V.Setting(r).setName("Sync editor folds with outline view").addDropdown(t=>{t.addOptions({"from-editor-to-outline":"From editor to outline",bidirectional:"Bidirectionally",none:"None"}),t.setValue(this.plugin.settings.syncOutlineView),t.onChange(n=>h(this,null,function*(){this.plugin.settings.syncOutlineView=n,yield this.plugin.saveSettings()}))}),r.createEl("h3",{text:"Crease Behavior"}),new V.Setting(r).setName("How should creases behave when opening a new file?").setDesc("By default, creases will not override what content you have folded in your file. You can change this so that creases always start folded.").addDropdown(t=>{t.addOptions({"always-fold":"Always fold creases","preserve-fold-state":"Respect existing fold state"}),t.setValue(this.plugin.settings.onOpenCreasesBehavior),t.onChange(n=>h(this,null,function*(){this.plugin.settings.onOpenCreasesBehavior=n,yield this.plugin.saveSettings()}))}),new V.Setting(r).setName("How should creases in templates behave?").setDesc("When creating a new file with creases in the template, do you want the creases to start folded or unfolded? Choose 'fold and clear' to have the creases folded and removed from the newly created note.").addDropdown(t=>{t.addOptions({"start-folded":"Start folded","start-unfolded":"Start unfolded","fold-and-clear":"Fold them and clear the creases"}),t.setValue(this.plugin.settings.templateCreasesBehavior),t.onChange(n=>h(this,null,function*(){this.plugin.settings.templateCreasesBehavior=n,yield this.plugin.saveSettings()}))})}};var sg=[1,2,3,4,5,6];function og(e,r,t){let{anchor:n,head:i}=e;return n.line>=r&&n.line<=t||i.line>=r&&i.line<=t||i.line<r&&n.line>t||n.line<r&&i.line>t}var lg=/\^([a-zA-Z0-9-]+)$/,ze=class extends y.Plugin{onload(){return h(this,null,function*(){yield this.loadSettings(),this.registerSettingsTab(),this.registerEditorExtension(ms(this.app)),this.addCommand({id:"fold",name:"Fold along creases",checkCallback:r=>{let t=this.app.workspace.getActiveViewOfType(y.MarkdownView);if(r)return!!t;t&&this.foldCreasesForView(t)}}),this.addCommand({id:"toggle-crease",name:"Toggle crease",editorCallback:this.toggleCrease.bind(this)}),this.addCommand({id:"crease-current-folds",name:"Crease the current folds",editorCallback:this.creaseCurrentFolds.bind(this)}),this.addCommand({id:"clear-creases",name:"Iron out (clear) the creases",editorCallback:this.clearCreases.bind(this)}),this.addCommand({id:"increase-fold-level-at-cursor",name:"Fold more",editorCallback:this.increaseFoldLevelAtCursor.bind(this)}),this.addCommand({id:"decrease-fold-level-at-cursor",name:"Fold less",editorCallback:this.decreaseFoldLevelAtCursor.bind(this)}),this.addCommand({id:"increase-fold-level",name:"Increase heading fold level",editorCallback:this.increaseHeadingFoldLevel.bind(this)}),this.addCommand({id:"decrease-fold-level",name:"Decrease heading fold level",editorCallback:this.decreaseHeadingFoldLevel.bind(this)}),this.app.workspace.onLayoutReady(()=>{this.patchCoreOutlinePlugin(),this.registerEvent(this.app.vault.on("create",this.onNewFile.bind(this))),this.patchCoreTemplatePlugin(),this.patchFileSuggest()}),sg.forEach(r=>{this.addCommand({id:`toggle-fold-heading-level-${r}`,name:`Toggle fold for H${r}`,checkCallback:t=>{var i,a;let n=this.app.workspace.getActiveViewOfType(y.MarkdownView);if(!n)return!1;if(t)return((a=(i=this.app.metadataCache.getFileCache(n.file))==null?void 0:i.headings)!=null?a:[]).find(l=>l.level===r)!==void 0;this.toggleFoldForHeadingLevel(n,r)}})}),this.onFileOpenListener=this.app.workspace.on("file-open",this.onFileOpen,this),this.registerEvent(this.onFileOpenListener),this.registerEvent(this.app.workspace.on("editor-menu",this.onEditorMenu,this)),this.registerEvent(this.app.workspace.on("templater:overwrite-file",this.onTemplaterNewFile,this)),this.registerEvent(this.app.workspace.on("templater:new-note-from-template",this.onTemplaterNewFile,this)),this.registerEvent(this.app.workspace.on("templater:template-appended",this.onTemplateAppend,this)),this.registerEvent(this.app.workspace.on("templates:template-appended",this.onTemplateAppend,this))})}increaseFoldLevelAtCursor(r,t){return h(this,null,function*(){var o;let n=yield this.app.foldManager.load(t.file),i=(o=n==null?void 0:n.folds)!=null?o:[];r.listSelections().forEach(l=>{let c=this.getAllParentFolds(r,l);for(let u=c.length-1;u>=0;u--){let p=c[u];if(!i.find(f=>f.from===p.from)){i.push(p);break}}}),t.currentMode.applyFoldInfo({folds:i,lines:t.editor.lineCount()}),t.onMarkdownFold()})}onFileOpen(r){this.app.workspace.activeLeaf&&(this.patchMarkdownView(),this.app.workspace.offref(this.onFileOpenListener))}handleNewFile(r,t){return h(this,null,function*(){["start-folded","fold-and-clear"].contains(this.settings.templateCreasesBehavior)&&x(t)&&(this.foldCreasesForFile(r),this.settings.templateCreasesBehavior==="fold-and-clear"&&this.app.vault.modify(r,t.replace(new RegExp(C,"g"),"")))})}onNewFile(r){return h(this,null,function*(){if(!(r instanceof y.TFile))return;let t=yield this.app.vault.cachedRead(r);this.handleNewFile(r,t)})}onTemplaterNewFile(r){return h(this,null,function*(){let{file:t,contents:n}=r;this.handleNewFile(t,n)})}onTemplateAppend(r){return h(this,null,function*(){if(["start-folded","fold-and-clear"].contains(this.settings.templateCreasesBehavior)){let{view:t,newSelections:n,oldSelections:i}=r,a=[],o=[];for(let l=0;l<n.length;l++){let[c,,,u]=(0,ws.default)([i[l].anchor,i[l].head,n[l].anchor,n[l].head],["line","ch"]),p=t.editor.getRange(c,u);if(x(p))for(let f=c.line;f<=u.line;f++){let d=t.editor.getLine(f);if(x(d)&&a.push({from:f,to:f+1}),this.settings.templateCreasesBehavior==="fold-and-clear"){let v=d.replace(C,"").trimEnd();o.push({text:v,from:{line:f,ch:0},to:{line:f+1,ch:0}})}}}t.currentMode.applyFoldInfo({folds:a,lines:t.editor.lineCount()}),t.editor.transaction({changes:o})}})}decreaseFoldLevelAtCursor(r,t){return h(this,null,function*(){var o;let n=yield this.app.foldManager.load(t.file),i=(o=n==null?void 0:n.folds)!=null?o:[];r.listSelections().forEach(l=>{let c=this.getAllParentFolds(r,l);for(let u=0;u<c.length;u++){let p=c[u];if(i.find(f=>f.from===p.from)){(0,qs.default)(i,f=>f.from===p.from);break}}}),t.currentMode.applyFoldInfo({folds:i,lines:t.editor.lineCount()}),t.onMarkdownFold()})}decreaseHeadingFoldLevel(r,t){return h(this,null,function*(){var u,p,f;let n=t.currentMode.getFoldInfo(),i=(u=n==null?void 0:n.folds)!=null?u:[],a=(f=(p=this.app.metadataCache.getFileCache(t.file))==null?void 0:p.headings)!=null?f:[],o=1;for(let d of a)i.find(v=>v.from===d.position.start.line)||(o=Math.max(o,d.level));let l=a.filter(d=>d.level===o),c=[...i,...l.map(d=>({from:d.position.start.line,to:d.position.end.line}))];t.currentMode.applyFoldInfo({folds:c,lines:t.editor.lineCount()}),t.onMarkdownFold()})}increaseHeadingFoldLevel(r,t){return h(this,null,function*(){var u,p,f;let n=t.currentMode.getFoldInfo(),i=(u=n==null?void 0:n.folds)!=null?u:[],a=(f=(p=this.app.metadataCache.getFileCache(t.file))==null?void 0:p.headings)!=null?f:[],o=Math.max(...a.map(d=>d.level));for(let d of a)i.find(v=>v.from===d.position.start.line)&&(o=Math.min(o,d.level));let l=new Set(a.filter(d=>d.level<=o).map(d=>d.position.start.line)),c=i.filter(d=>!l.has(d.from));t.currentMode.applyFoldInfo({folds:c,lines:t.editor.lineCount()}),t.onMarkdownFold()})}patchMarkdownView(){let r=this,{workspace:t}=this.app,n=t.activeLeaf;!n||this.register(ae(n.view.constructor.prototype,{onMarkdownFold(i){return function(){return h(this,null,function*(){if(yield i.call(this),r.settings.syncOutlineView==="none")return;let a=this.currentMode.getFoldInfo(),o=t.getLeavesOfType("outline")[0];if(o){let l=o.view;if(l.file===this.file){let c=l.treeView;for(let u of c.allItems){let p=!!(a==null?void 0:a.folds.find(f=>f.from===u.heading.position.start.line));u.setCollapsed(p)}}}})}},onLoadFile(i){return function(a){return h(this,null,function*(){yield i.call(this,a),a&&r.settings.onOpenCreasesBehavior==="always-fold"&&r.foldCreasesForFile(a)})}}}))}patchCoreTemplatePlugin(){let r=this.app.internalPlugins.getPluginById("templates");!r||this.register(ae(r.instance.constructor.prototype,{insertTemplate(t){return function(n){return h(this,null,function*(){let i=this.app.workspace.getActiveViewOfType(y.MarkdownView);if(!i)return;let a=i.editor.listSelections();yield t.call(this,n);let o=i.editor.listSelections();this.app.workspace.trigger("templates:template-appended",{content:this.app.vault.cachedRead(n),oldSelections:a,newSelections:o,view:i})})}}}))}getAnyLeaf(){let r=this.app.workspace.activeLeaf;return r||(this.app.workspace.iterateAllLeaves(t=>{r||(r=t)}),r)}patchCoreOutlinePlugin(){let r=this.getAnyLeaf(),t=this,n;try{n=this.app.viewRegistry.viewByType.outline(r)}catch(l){return}let i=n.treeView,a=createDiv(),o=i.constructor(a);o.renderOutline([{heading:"test",level:1}]),this.register(ae(o.allItems[0].constructor.prototype,{onCollapseClick(l){return function(c){var p,f;if(l.call(this,c),t.settings.syncOutlineView!=="bidirectional")return;let u=t.app.workspace.getActiveViewOfType(y.MarkdownView);if(u){let d=(f=(p=u.currentMode.getFoldInfo())==null?void 0:p.folds)!=null?f:[];if(this.collapsed){let v=[...d,{from:this.heading.position.start.line,to:this.heading.position.start.line+1}];u.currentMode.applyFoldInfo({folds:v,lines:u.editor.lineCount()})}else u.currentMode.applyFoldInfo({folds:d.filter(v=>this.heading.position.start.line!==v.from),lines:u.editor.lineCount()});u.onMarkdownFold()}}},render(l){return function(){var u,p;l.call(this);let c=t.app.workspace.getActiveViewOfType(y.MarkdownView);c&&(this.innerEl.empty(),y.MarkdownRenderer.renderMarkdown(this.heading.heading,this.innerEl,c.file.path,this),((p=(u=c.currentMode.getFoldInfo())==null?void 0:u.folds)!=null?p:[]).find(d=>d.from===this.heading.position.start.line)&&this.setCollapsed(!0))}}})),n.close()}patchFileSuggest(){let t=this.app.workspace.editorSuggest.suggests.find(n=>n.mode!==void 0);!t||this.register(ae(t.constructor.prototype,{getGlobalBlockSuggestions(n){return function(...i){return h(this,null,function*(){let a=yield n.call(this,...i);return a?a.map(o=>o.node.type!=="heading"?o:ue(le({},o),{display:(0,y.stripHeading)(o.node.data.hProperties.dataHeading.replace(C,""))})):null})}},getGlobalHeadingSuggestions(n){return function(...i){return h(this,null,function*(){let a=yield n.call(this,...i);return a?a.map(o=>ue(le({},o),{heading:(0,y.stripHeading)(o.heading.replace(C,""))})):null})}},getHeadingSuggestions(n){return function(...i){return h(this,null,function*(){let a=yield n.call(this,...i);return a?a.map(o=>ue(le({},o),{heading:(0,y.stripHeading)(o.heading.replace(C,""))})):null})}}}))}getAllParentFolds(r,t){return this.getAllFoldableLines(r).filter(i=>og(t,i.from,i.to))}getAllFoldableLines(r){if(this.app.vault.getConfig("legacyEditor")){let n=r.cm.state.foldGutter.options,i=r.cm.foldOption(n,"rangeFinder"),a=[];for(let o=0;o<=r.lastLine();o++){let l=i(r.cm,CodeMirror.Pos(o,0));l&&a.push({from:l.from.line,to:l.to.line})}return a}let t=[];for(let n=0;n<=r.lastLine();n++){let i=r.posToOffset({line:n,ch:0}),a=(0,Cs.foldable)(r.cm.state,i,i);if(a){let o=r.offsetToPos(a.from),l=r.offsetToPos(a.to);t.push({from:o.line,to:l.line})}}return t}getRelevantFold(r,t){let n=this.getAllFoldableLines(r);for(let i=n.length-1;i>=0;i--){let a=n[i];if(a.from<=t.anchor.line&&t.anchor.line<=a.to)return a}return null}onEditorMenu(r,t,n){!t.getSelection()||r.addItem(i=>i.setTitle("Toggle crease").setIcon("shirt").onClick(()=>{this.toggleCrease(t,n)}))}toggleCrease(r,t){r.listSelections().forEach(i=>{let a=this.getRelevantFold(r,i);if(!a)return;let o=a.from,l=r.getLine(o);if(x(l)){let c={line:o,ch:0},u={line:o,ch:l.length},p=l.replace(C,"").trimEnd();r.replaceRange(p,c,u)}else{let c=l.length,u=lg.exec(l);u&&(c=u.index-1);let p={line:o,ch:c},f={line:o,ch:c};r.replaceRange(" %% fold %% ",p,f)}})}getCreasesFromFile(r){return h(this,null,function*(){let n=(yield this.app.vault.cachedRead(r)).split(`
`),i=[];for(let a=0;a<=n.length;a++){let o=n[a];x(o)&&i.push({from:a,to:a+1})}return i})}getCreasesFromEditor(r){let t=[];for(let n=0;n<=r.lastLine();n++){let i=r.getLine(n);x(i)&&t.push({from:n,to:n+1})}return t}foldCreasesForView(r){return h(this,null,function*(){var i;let t=r.currentMode.getFoldInfo(),n=[...(i=t==null?void 0:t.folds)!=null?i:[],...this.getCreasesFromEditor(r.editor)];r.currentMode.applyFoldInfo({folds:n,lines:r.editor.lineCount()})})}foldCreasesForFile(r){return h(this,null,function*(){var l,c,u;let t=yield this.app.vault.cachedRead(r),n=yield this.app.foldManager.load(r),a={folds:[...(l=n==null?void 0:n.folds)!=null?l:[],...yield this.getCreasesFromFile(r)],lines:(u=(c=t.match(/^/gm))==null?void 0:c.length)!=null?u:0},o=this.app.workspace.getLeavesOfType("markdown").filter(p=>p.view&&p.view instanceof y.MarkdownView&&p.view.file===r);o.length?o[0].view.currentMode.applyFoldInfo(a):yield this.app.foldManager.save(r,a)})}toggleFoldForHeadingLevel(r,t){var l,c,u;let n=(c=(l=r.currentMode.getFoldInfo())==null?void 0:l.folds)!=null?c:[],i=(((u=this.app.metadataCache.getFileCache(r.file))==null?void 0:u.headings)||[]).filter(p=>p.level===t),a=new Set(i.map(p=>p.position.start.line)),o=i[0].position.start;if(n.find(p=>p.from===o.line))r.currentMode.applyFoldInfo({folds:n.filter(p=>!a.has(p.from)),lines:r.editor.lineCount()}),r.onMarkdownFold();else{let p=[...n,...i.map(f=>({from:f.position.start.line,to:f.position.start.line+1}))];r.currentMode.applyFoldInfo({folds:p,lines:r.editor.lineCount()}),r.onMarkdownFold()}}creaseCurrentFolds(r,t){var a;let n=t.currentMode.getFoldInfo(),i=[];((a=n==null?void 0:n.folds)!=null?a:[]).forEach(o=>{let l=r.getLine(o.from);if(!x(l)){let c={line:o.from,ch:l.length};i.push({text:" %% fold %%",from:c,to:c})}}),r.transaction({changes:i})}clearCreases(r,t){let n=[];for(let i=0;i<r.lastLine();i++){let a=r.getLine(i);x(a)&&n.push({text:a.replace(C,""),from:{line:i,ch:0},to:{line:i,ch:a.length}})}r.transaction({changes:n})}loadSettings(){return h(this,null,function*(){this.settings=Object.assign({},bs,yield this.loadData())})}saveSettings(){return h(this,null,function*(){yield this.saveData(this.settings)})}registerSettingsTab(){this.addSettingTab(new Ue(this.app,this))}};
